#+TITLE: Political Economy of Platform Worker
#+SUBTITLE: Mphil Dissertation
#+AUTHOR: Dishi Agarwal
#+DATE: Nov 4, 2019
#+OPTIONS: toc:2 H:3 num:2
#+PROPERTY:  header-args:R :eval never-export :session plfs 
#+SETUPFILE: https://fniessen.github.io/org-html-themes/setup/theme-readtheorg.setup
#+HTML_HEAD: <style>#content{max-width:1200px;} </style>
#+MCRO: hlmacro (eval (org-table-insert-hline))


* Preliminary data analysis
** Principal Activity Status
#+NAME: FPER_FV
#+BEGIN_SRC R :session plfs :results value silent :exports none
  setwd("/users/dishi/Mphil")
  library(data.table)
  D1 <- read.fwf("/users/dishi/Mphil/FPER_FV.TXT", widths = c(4,3,2,2,1,2,2,3,2,2,1,4,5,1,1,2,2,1,1,3,1,2,2,2,2,1,1,2,1,1,1,2,5,3,1,2,2,1,1,1,1,2,5,3,2,2,1,1,1,1,2,2,2,5,2,2,2,5,2,2,2,2,2,5,2,2,2,5,2,2,2,2,2,5,2,2,22,2,2,2,2,5,2,2,2,5,2,2,2,2,2,5,2,2,2,5,2,2,2,2,2,5,2,2,2,5,2,2,2,2,2,5,2,2,2,5,2,2,2,2,3,8,8,3,3,10,1 ))
  D<-data.table(D1)

#+END_SRC
*** Distribution of NCO Codes other than code 832 for the relevant NIC classification in an Urban area
#+NAME: Distribution of NCO Codes other than code 832 for the relevant NIC classification in an Urban area
#+BEGIN_SRC R :q session plfs :results value :exports results :colnames yes :hline yes
  library(dplyr)
  library(ggplot2)
  library(tidyr)
  library(scales)
  A <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]
  B <-D[ V33 %in% c(49219,56104,49223,49224,49231)][!(V34 %in% c(832))]
  A[,Vdistrict := (100*V6 + V7)]
  E <- data.table(
    V34 = c(112,114,121,122,123,130,213,241,242,312,341,342,343,411,412,
            413,419,421,511,512,513,514,516,522,611,615,711,723,812,815,823,827,829,831,833,
            834,911,913,914,915,920,931,933),
    NCO_Code_Description_2004 = c(
      "Administrative & Executive Officials",
      "Senior Officials of Special- Interest Organisations",
      "Directors and Chief Executives",
      "Production and Operations Department Managers",
      "Other Department Managers",
      "General Managers",
      "Computing Professionals",
      "Business Professionals",
      "Legal Professionals",
      "Computer Associate Professionals",
      "Finance and Sales Associate Professionals",
      "Business Services Agents and Trade Brokers",
      "Administrative Associate Professionals",
      "Secretaries and Key Board- Operating Clerks",
      "Numerical Clerks",
      "Material Recording and Transport Clerks",
      "Other Office Clerks",
      "Cashiers Tellers and Related Clerks Travel Attendants",
      "Guides and Related Workers",
      "House Keeping and Restaurant Services Workers",
      "Personal Care and Related Workers",
      " Other Personal Services Workers",
      "Protective Services Workers",
      "Shop Salespersons and Demonstrator",
      " Market Gardners & Crop Growers",
      " Fishery Workers, Hunters and Trappers",
      "Miners Shot -Firers Stone Cutters and Carvers",
      " Machinery Mechanics and Fitters",
      "Metal Processing Plant Operators",
      "Chemical- Processing- Plant Operators",
      "Rubber and Plastic Products Machine Operators",
      "Food and Related Products Machine Operators",
      "Other Machine Operators and Assemblers",
      "Locomotive Engine Drivers and Related Workers",
      "Agricultural and Other Mobile Plant Operators",
      "Ships’ Deck Crews and Related Workers",
      "Street Vendors and Related Workers",
      "Domestic and Related Helpers, Cleaners and Launderers",
      "Building Caretakers, Window and Related Cleaners",
      "Messengers, Porters,Door Keepers and Related Workers",
      "Agricultural,Fishery and Related Labourers",
      "Mining and Construction Labourers",
      "Transport Labourers and Freight Handlers"
    ))

  merge(B,E,by=c("V34"),all.x=T)-> C
  C[V5==2,.(No_of_observation = .N), by=.(NCO_code=V34,NCO_Code_Description_2004,V33)]
#+END_SRC

#+CAPTION:Distribution of NCO Codes other than code 832 for the relevant NIC classification in an Urban area
#+RESULTS: Different NCO Classifications other than code 832 for the relevant NIC classification
| NCO_code | NCO_Code_Description_2004                             |   V33 | No_of_observation |
|----------+-------------------------------------------------------+-------+-------------------|
|      112 | Administrative & Executive Officials                  | 49224 |                 3 |
|      112 | Administrative & Executive Officials                  | 49219 |                 1 |
|      114 | Senior Officials of Special- Interest Organisations   | 49219 |                 1 |
|      121 | Directors and Chief Executives                        | 49224 |               170 |
|      121 | Directors and Chief Executives                        | 49231 |               113 |
|      121 | Directors and Chief Executives                        | 49219 |                67 |
|      121 | Directors and Chief Executives                        | 49223 |                 7 |
|      121 | Directors and Chief Executives                        | 56104 |                 3 |
|      122 | Production and Operations Department Managers         | 49231 |                 8 |
|      122 | Production and Operations Department Managers         | 49219 |                 2 |
|      123 | Other Department Managers                             | 49224 |                 1 |
|      123 | Other Department Managers                             | 49231 |                 1 |
|      213 | Computing Professionals                               | 49231 |                 1 |
|      241 | Business Professionals                                | 49219 |                 4 |
|      241 | Business Professionals                                | 49231 |                 5 |
|      241 | Business Professionals                                | 56104 |                 1 |
|      241 | Business Professionals                                | 49223 |                 4 |
|      241 | Business Professionals                                | 49224 |                 7 |
|      312 | Computer Associate Professionals                      | 49231 |                 1 |
|      341 | Finance and Sales Associate Professionals             | 49231 |                 2 |
|      342 | Business Services Agents and Trade Brokers            | 49231 |                 4 |
|      343 | Administrative Associate Professionals                | 49231 |                 2 |
|      411 | Secretaries and Key Board- Operating Clerks           | 49231 |                 2 |
|      412 | Numerical Clerks                                      | 49231 |                 6 |
|      412 | Numerical Clerks                                      | 56104 |                 1 |
|      413 | Material Recording and Transport Clerks               | 49224 |                 1 |
|      413 | Material Recording and Transport Clerks               | 49223 |                 1 |
|      413 | Material Recording and Transport Clerks               | 49231 |                10 |
|      419 | Other Office Clerks                                   | 49219 |                 3 |
|      419 | Other Office Clerks                                   | 49231 |                 7 |
|      419 | Other Office Clerks                                   | 56104 |                 1 |
|      421 | Cashiers Tellers and Related Clerks Travel Attendants | 49231 |                 1 |
|      421 | Cashiers Tellers and Related Clerks Travel Attendants | 49224 |                 1 |
|      511 | Guides and Related Workers                            | 49219 |                 6 |
|      511 | Guides and Related Workers                            | 49231 |                 7 |
|      511 | Guides and Related Workers                            | 49223 |                 1 |
|      512 | House Keeping and Restaurant Services Workers         | 56104 |                 5 |
|      512 | House Keeping and Restaurant Services Workers         | 49224 |                 1 |
|      513 | Personal Care and Related Workers                     | 49219 |                 1 |
|      514 | Other Personal Services Workers                       | 49224 |                 2 |
|      516 | Protective Services Workers                           | 49231 |                 1 |
|      516 | Protective Services Workers                           | 49219 |                 1 |
|      522 | Shop Salespersons and Demonstrator                    | 56104 |                 2 |
|      615 | Fishery Workers, Hunters and Trappers                 | 49219 |                 1 |
|      723 | Machinery Mechanics and Fitters                       | 49231 |                 9 |
|      723 | Machinery Mechanics and Fitters                       | 49224 |                 1 |
|      723 | Machinery Mechanics and Fitters                       | 49219 |                 2 |
|      812 | Metal Processing Plant Operators                      | 49231 |                 1 |
|      815 | Chemical- Processing- Plant Operators                 | 49231 |                 2 |
|      823 | Rubber and Plastic Products Machine Operators         | 49219 |                 1 |
|      827 | Food and Related Products Machine Operators           | 49231 |                 3 |
|      829 | Other Machine Operators and Assemblers                | 49231 |                 3 |
|      831 | Locomotive Engine Drivers and Related Workers         | 49223 |                11 |
|      831 | Locomotive Engine Drivers and Related Workers         | 49231 |                 5 |
|      831 | Locomotive Engine Drivers and Related Workers         | 49224 |                 6 |
|      831 | Locomotive Engine Drivers and Related Workers         | 49219 |                 2 |
|      833 | Agricultural and Other Mobile Plant Operators         | 49231 |                10 |
|      834 | Ships’ Deck Crews and Related Workers                 | 49224 |                 1 |
|      834 | Ships’ Deck Crews and Related Workers                 | 49231 |                 2 |
|      911 | Street Vendors and Related Workers                    | 49231 |                 1 |
|      913 | Domestic and Related Helpers, Cleaners and Launderers | 49231 |                 2 |
|      915 | Messengers, Porters,Door Keepers and Related Workers  | 49231 |                 4 |
|      915 | Messengers, Porters,Door Keepers and Related Workers  | 56104 |                 1 |
|      920 | Agricultural,Fishery and Related Labourers            | 49231 |                 4 |
|      931 | Mining and Construction Labourers                     | 49219 |                 1 |
|      931 | Mining and Construction Labourers                     | 49231 |                 2 |
|      933 | Transport Labourers and Freight Handlers              | 49231 |                81 |
|      933 | Transport Labourers and Freight Handlers              | 49219 |                17 |
|      933 | Transport Labourers and Freight Handlers              | 49224 |                 8 |
|      933 | Transport Labourers and Freight Handlers              | 49223 |                 3 |

*** Reanalysing shortlisted NCO and NIC codes for their relevance
#+NAME: Reanalysing shortlisted NCO and NIC codes for their relevance
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline yes
  N1 <- data.table(V33 = c(49231,49224,49223,49219,56104),
                   NIC_code_discription = c(
                     "Motorised Freight transport",
                     "taxi operations",
                     "rental of private cars with drivers",
                     "urban&suburban passenger transport..",
                     "Restaurant & barfood activities.."
                   ))

  N2<- data.table(V34 = c(832,933,512),
                  NCO_Code_Description_2004=c("MotorVehicleDrivers",
                                              "Trans Labour & FreightHandlers",
                                              "HouseKeeping&Rest ServicesWorkers"
                                              ))
  A[V5==2,.N,by=.(V33,V34)]-> N

  merge(N,N1,by = "V33") -> N
  merge(N,N2,by = "V34") -> N
#+END_SRC
#+RESULTS: Reanalysing shortlisted NCO and NIC codes for their relevance
| V34 |   V33 |   N | NIC_code_discription                 | NCO_Code_Description_2004         |
|-----+-------+-----+--------------------------------------+-----------------------------------|
| 512 | 49224 |   1 | taxi operations                      | HouseKeeping&Rest ServicesWorkers |
| 512 | 56104 |   5 | Restaurant & barfood activities..    | HouseKeeping&Rest ServicesWorkers |
| 832 | 49219 | 471 | urban&suburban passenger transport.. | MotorVehicleDrivers               |
| 832 | 49223 | 249 | rental of private cars with drivers  | MotorVehicleDrivers               |
| 832 | 49224 | 893 | taxi operations                      | MotorVehicleDrivers               |
| 832 | 49231 | 531 | Motorised Freight transport          | MotorVehicleDrivers               |
| 933 | 49219 |  17 | urban&suburban passenger transport.. | Trans Labour & FreightHandlers    |
| 933 | 49223 |   3 | rental of private cars with drivers  | Trans Labour & FreightHandlers    |
| 933 | 49224 |   8 | taxi operations                      | Trans Labour & FreightHandlers    |
| 933 | 49231 |  81 | Motorised Freight transport          | Trans Labour & FreightHandlers    |

*** Sector Wise 
#+Name:Sector Wise Distribution
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline yes
  sector <- data.table(V5 = c(1,2),Sector = c("Rural","Urban"))
  merge(A,sector,by ="V5")->a1
  a1[,.(No_of_observation = .N), by=Sector]
#+END_SRC
#+RESULTS: Sector Wise Distribution
| Sector | No_of_observation |
|--------+-------------------|
| Rural  |              2001 |
| Urban  |              2259 |
##Will only be taking Urban Sector in this analysis
*** State & District  Wise Distribution
#+NAME: State Wise Distribution
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline yes
  state <- data.table(V6 = c(01,02,03,04,05,06,07,08,09,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36),State_Names = c("Jammu & Kashmir","Himachal Pradesh","Punjab","Chandigarh","Uttrakhand","Haryana","Delhi","Rajasthan","Uttar Pradesh","Bihar","Sikkim","ArunachalPradesh","Nagaland","Manipur","Mizoram","Tripura","Meghalaya","Assam","West Bengal","Jharkhand","Odisha","Chhattisgarh","Madhya Pradesh","Gujarat","Daman & Diu","D & N Haveli" ,"Maharashtra" ,"Andhra Pradesh","Karnataka","Goa","Lakshadweep","Kerala" ,"Tamil Nadu" ,"Puducherry","A & N Island" ,"Telangana"))
  merge(A,state,by ="V6")-> a2
  a2[V5==2,.(No_of_observation = .N), by= .(V6,State_Names)]
#+END_SRC
#+RESULTS: State Wise Distribution
| V6 | State_Names      | No_of_observation |
|----+------------------+-------------------|
|  1 | Jammu & Kashmir  |                93 |
|  2 | Himachal Pradesh |                11 |
|  3 | Punjab           |                61 |
|  4 | Chandigarh       |                17 |
|  5 | Uttrakhand       |                20 |
|  6 | Haryana          |                57 |
|  7 | Delhi            |                51 |
|  8 | Rajasthan        |                68 |
|  9 | Uttar Pradesh    |               118 |
| 10 | Bihar            |                35 |
| 11 | Sikkim           |                19 |
| 12 | ArunachalPradesh |                22 |
| 13 | Nagaland         |                20 |
| 14 | Manipur          |                42 |
| 15 | Mizoram          |                72 |
| 16 | Tripura          |                41 |
| 17 | Meghalaya        |                32 |
| 18 | Assam            |                44 |
| 19 | West Bengal      |               145 |
| 20 | Jharkhand        |                47 |
| 21 | Odisha           |                47 |
| 22 | Chhattisgarh     |                46 |
| 23 | Madhya Pradesh   |               106 |
| 24 | Gujarat          |               119 |
| 25 | Daman & Diu      |                 4 |
| 26 | D & N Haveli     |                 8 |
| 27 | Maharashtra      |               283 |
| 28 | Andhra Pradesh   |                90 |
| 29 | Karnataka        |                93 |
| 30 | Goa              |                10 |
| 31 | Lakshadweep      |                 6 |
| 32 | Kerala           |               123 |
| 33 | Tamil Nadu       |               173 |
| 34 | Puducherry       |                22 |
| 35 | A & N Island     |                19 |
| 36 | Telangana        |                95 |


#+NAME:District Codes
#+BEGIN_SRC R :session plfs :results value silent :exports results 
  Vdistrict = c(107,
                121,
                122,
                105,
                106,
                116,
                117,
                118,
                119,
                120,
                101,
                102,
                108,
                109,
                110,
                111,
                112,
                113,
                114,
                115,
                103,
                104,
                202,
                204,
                205,
                206,
                207,
                201,
                203,
                208,
                209,
                210,
                211,
                212,
                301,
                302,
                303,
                304,
                305,
                315,
                316,
                317,
                318,
                321,
                306,
                307,
                308,
                309,
                310,
                311,
                312,
                313,
                314,
                319,
                320,
                322,
                401,
                501,
                502,
                503,
                504,
                505,
                506,
                507,
                508,
                509,
                510,
                511,
                512,
                513,
                601,
                602,
                603,
                604,
                605,
                606,
                607,
                608,
                614,
                615,
                618,
                619,
                620,
                621,
                609,
                610,
                611,
                612,
                613,
                616,
                617,
                701,
                702,
                703,
                704,
                705,
                706,
                707,
                708,
                709,
                803,
                815,
                816,
                817,
                818,
                819,
                820,
                806,
                807,
                808,
                809,
                810,
                811,
                812,
                821,
                822,
                824,
                825,
                826,
                827,
                832,
                823,
                828,
                829,
                830,
                831,
                833,
                801,
                802,
                804,
                805,
                813,
                814,
                901,
                902,
                903,
                904,
                905,
                906,
                907,
                908,
                909,
                910,
                923,
                924,
                925,
                926,
                927,
                932,
                933,
                941,
                945,
                942,
                943,
                944,
                946,
                947,
                948,
                949,
                950,
                951,
                952,
                953,
                954,
                955,
                956,
                957,
                958,
                959,
                960,
                961,
                962,
                963,
                964,
                965,
                966,
                967,
                968,
                969,
                934,
                935,
                936,
                937,
                938,
                939,
                940,
                911,
                912,
                913,
                914,
                915,
                916,
                917,
                918,
                919,
                920,
                921,
                922,
                928,
                929,
                930,
                931,
                970,
                971,
                1001,
                1002,
                1003,
                1004,
                1005,
                1006,
                1007,
                1008,
                1009,
                1010,
                1011,
                1012,
                1013,
                1014,
                1015,
                1016,
                1017,
                1018,
                1019,
                1020,
                1021,
                1022,
                1023,
                1024,
                1025,
                1026,
                1027,
                1028,
                1029,
                1030,
                1031,
                1032,
                1033,
                1034,
                1035,
                1036,
                1037,
                1038,
                1101,
                1102,
                1103,
                1104,
                1201,
                1202,
                1203,
                1204,
                1205,
                1206,
                1207,
                1208,
                1209,
                1210,
                1211,
                1212,
                1213,
                1214,
                1215,
                1216,
                1301,
                1302,
                1303,
                1304,
                1305,
                1306,
                1307,
                1308,
                1309,
                1310,
                1311,
                1404,
                1405,
                1406,
                1407,
                1401,
                1402,
                1403,
                1408,
                1409,
                1501,
                1502,
                1503,
                1504,
                1505,
                1506,
                1507,
                1508,
                1601,
                1602,
                1603,
                1604,
                1701,
                1702,
                1703,
                1704,
                1705,
                1706,
                1707,
                1808,
                1809,
                1810,
                1811,
                1812,
                1813,
                1814,
                1801,
                1802,
                1803,
                1804,
                1820,
                1821,
                1822,
                1823,
                1824,
                1825,
                1815,
                1816,
                1817,
                1818,
                1819,
                1805,
                1806,
                1807,
                1826,
                1827,
                1901,
                1902,
                1903,
                1904,
                1905,
                1906,
                1907,
                1908,
                1910,
                1911,
                1916,
                1917,
                1909,
                1912,
                1915,
                1913,
                1914,
                1918,
                1919,
                2001,
                2011,
                2012,
                2013,
                2014,
                2019,
                2020,
                2021,
                2022,
                2023,
                2024,
                2002,
                2003,
                2004,
                2005,
                2006,
                2007,
                2008,
                2009,
                2010,
                2015,
                2016,
                2017,
                2018,
                2108,
                2109,
                2110,
                2111,
                2112,
                2113,
                2116,
                2117,
                2118,
                2119,
                2120,
                2121,
                2122,
                2123,
                2124,
                2125,
                2126,
                2127,
                2128,
                2129,
                2130,
                2101,
                2102,
                2103,
                2104,
                2105,
                2106,
                2107,
                2114,
                2115,
                2201,
                2202,
                2226,
                2227,
                2203,
                2204,
                2205,
                2206,
                2207,
                2208,
                2209,
                2210,
                2211,
                2212,
                2213,
                2219,
                2220,
                2223,
                2224,
                2225,
                2214,
                2215,
                2216,
                2217,
                2218,
                2221,
                2222,
                2307,
                2308,
                2309,
                2312,
                2313,
                2314,
                2343,
                2344,
                2345,
                2346,
                2310,
                2311,
                2326,
                2327,
                2328,
                2329,
                2315,
                2316,
                2317,
                2318,
                2319,
                2320,
                2321,
                2322,
                2325,
                2347,
                2348,
                2333,
                2334,
                2335,
                2336,
                2337,
                2338,
                2339,
                2340,
                2323,
                2324,
                2330,
                2331,
                2332,
                2349,
                2350,
                2301,
                2302,
                2303,
                2304,
                2305,
                2306,
                2341,
                2342,
                2417,
                2418,
                2419,
                2420,
                2421,
                2422,
                2423,
                2424,
                2425,
                2426,
                2404,
                2405,
                2406,
                2407,
                2415,
                2416,
                2402,
                2403,
                2401,
                2408,
                2409,
                2410,
                2411,
                2412,
                2413,
                2414,
                2501,
                2502,
                2601,
                2721,
                2722,
                2723,
                2724,
                2732,
                2733,
                2725,
                2726,
                2730,
                2731,
                2734,
                2735,
                2701,
                2702,
                2703,
                2720,
                2715,
                2716,
                2717,
                2718,
                2719,
                2727,
                2728,
                2729,
                2704,
                2705,
                2706,
                2707,
                2708,
                2709,
                2714,
                2710,
                2711,
                2712,
                2713,
                2801,
                2802,
                2803,
                2804,
                2805,
                2806,
                2807,
                2808,
                2809,
                2810,
                2811,
                2812,
                2813,
                2909,
                2915,
                2921,
                2914,
                2916,
                2920,
                2922,
                2917,
                2918,
                2919,
                2923,
                2924,
                2927,
                2928,
                2929,
                2930,
                2901,
                2902,
                2903,
                2904,
                2905,
                2906,
                2907,
                2908,
                2910,
                2911,
                2912,
                2913,
                2925,
                2926,
                3001,
                3002,
                3101,
                3201,
                3202,
                3203,
                3204,
                3205,
                3206,
                3207,
                3208,
                3209,
                3210,
                3211,
                3212,
                3213,
                3214,
                3301,
                3302,
                3303,
                3304,
                3305,
                3306,
                3316,
                3312,
                3313,
                3314,
                3315,
                3317,
                3318,
                3319,
                3320,
                3311,
                3321,
                3322,
                3323,
                3324,
                3325,
                3326,
                3327,
                3328,
                3307,
                3308,
                3309,
                3310,
                3329,
                3330,
                3331,
                3332,
                3401,
                3402,
                3403,
                3404,
                3501,
                3502,
                3503,
                3601,
                3602,
                3604,
                3605,
                3606,
                3607,
                3603,
                3608,
                3609,
                3610 )

  District_Names = c("Kathua",
                     "Jammu",
                     "Samba",
                     "Punch",
                     "Rajouri",
                     "Doda",
                     "Ramban",
                     "Kishtwar",
                     "Udhampur",
                     "Reasi",
                     "Kupwara",
                     "Badgam",
                     "Baramula",
                     "Bandipore",
                     "Srinagar",
                     "Ganderbal",
                     "Pulwama",
                     "Shupiyan",
                     "Anantnag",
                     "Kulgam",
                     "Leh (Ladakh)",
                     "Kargil",
                     "Kangra",
                     "Kullu",
                     "Mandi",
                     "Hamirpur",
                     "Una",
                     "Chamba",
                     "Lahul & Spiti",
                     "Bilaspur",
                     "Solan",
                     "Sirmaur",
                     "Shimla",
                     "Kinnaur",
                     "Gurdaspur",
                     "Kapurthala",
                     "Jalandhar",
                     "Hoshiarpur",
                     "Shahid Bhagat Singh Nagar",
                     "Amritsar",
                     "Tarn Taran",
                     "Rupnagar",
                     "Sahibzada Ajit Singh Nagar",
                     "Pathankot","Fatehgarh Sahib",
                     "Ludhiana",
                     "Moga",
                     "Firozpur",
                     "Muktsar",
                     "Faridkot",
                     "Bathinda",
                     "Mansa",
                     "Patiala",
                     "Sangrur",
                     "Barnala",
                     "Fazilka",
                     "Chandigarh",
                     "Uttarkashi",
                     "Chamoli",
                     "Rudraprayag",
                     "Tehri Garhwal",
                     "Dehradun",
                     "Garhwal",
                     "Pithoragarh",
                     "Bageshwar",
                     "Almora",
                     "Champawat",
                     "Nainital",
                     "Udham Singh Nagar",
                     "Hardwar",
                     "Panchkula",
                     "Ambala",
                     "Yamunanagar",
                     "Kurukshetra",
                     "Kaithal",
                     "Karnal",
                     "Panipat",
                     "Sonipat",
                     "Rohtak",
                     "Jhajjar",
                     "Gurgaon",
                     "Mewat",
                     "Faridabad",
                     "Palwal",
                     "Jind",
                     "Fatehabad",
                     "Sirsa",
                     "Hisar",
                     "Bhiwani",
                     "Mahendragarh",
                     "Rewari",
                     "North West Delhi",
                     "North Delhi",
                     "North East Delhi",
                     "East Delhi",
                     "New Delhi",
                     "Central Delhi",
                     "West Delhi",
                     "South West Delhi",
                     "South Delhi",
                     "Bikaner",
                     "Jodhpur",
                     "Jaisalmer",
                     "Barmer",
                     "Jalor",
                     "Sirohi",
                     "Pali",
                     "Alwar",
                     "Bharatpur",
                     "Dhaulpur",
                     "Karauli",
                     "Sawai Madhopur",
                     "Dausa",
                     "Jaipur",
                     "Ajmer",
                     "Tonk",
                     "Dhilwara",
                     "Rajsamand",
                     "Dungarpur",
                     "Banswara",
                     "Udaipur",
                     "Bundi",
                     "Chittaurgarh",
                     "Kota",
                     "Baran",
                     "Jhalawar",
                     "Pratapgarh",
                     "Ganganagar",
                     "Hanumangarh",
                     "Churu",
                     "Jhunjhunun",
                     "Sikar",
                     "Nagaur",
                     "Saharanpur",
                     "Muzaffarnagar",
                     "Bijnor",
                     "Moradabad",
                     "Rampur",
                     "Jyotiba Phule Nagar",
                     "Meerut",
                     "Baghpat",
                     "Ghaziabad",
                     "Gautam Buddha Nagar",
                     "Sitapur",
                     "Hardoi",
                     "Unnao",
                     "Lucknow",
                     "Rae Bareli",
                     "Kanpur Dehat",
                     "Kanpur Nagar",
                     "Fatehpur",
                     "Bara Banki",
                     "Pratapgarh",
                     "Kaushambi",
                     "Allahabad",
                     "Faizabad",
                     "Ambedkar Nagar",
                     "Sultanpur",
                     "Bahraich",
                     "Shrawasti",
                     "Balrampur",
                     "Gonda",
                     "Siddharthnagar",
                     "Basti",
                     "Sant Kabir Nagar",
                     "Mahrajganj",
                     "Gorakhpur",
                     "Kushinagar",
                     "Deoria",
                     "Azamgarh",
                     "Mau",
                     "Ballia",
                     "Jaunpur","Ghazipur",
                     "Chandauli",
                     "Varanasi",
                     "Sant Ravidas Nagar (Bhadohi)",
                     "Mirzapur",
                     "Sonbhadra",
                     "Jalaun",
                     "Jhansi",
                     "Lalitpur",
                     "Hamirpur",
                     "Mahoba",
                     "Banda",
                     "Chitrakoot",
                     "Bulandshahr",
                     "Aligarh",
                     "Mahamaya Nagar",
                     "Mathura",
                     "Agra",
                     "Firozabad",
                     "Mainpuri",
                     "Budaun",
                     "Bareilly",
                     "Pilibhit",
                     "Shahjahanpur",
                     "Kheri",
                     "Farrukhabad",
                     "Kannauj",
                     "Etawah",
                     "Auraiya",
                     "Etah",
                     "Kanshiram Nagar",
                     "Pashchim Champaran",
                     "Purba Champaran",
                     "Sheohar",
                     "Sitamarhi",
                     "Madhubani",
                     "Supaul",
                     "Araria",
                     "Kishanganj",
                     "Purnia",
                     "Katihar",
                     "Madhepura",
                     "Saharsa",
                     "Darbhanga",
                     "Muzaffarpur",
                     "Gopalganj",
                     "Siwan",
                     "Saran",
                     "Vaishali",
                     "Samastipur",
                     "Begusarai",
                     "Khagaria",
                     "Bhagalpur",
                     "Banka",
                     "Munger","Lakhisarai",
                     "Sheikhpura",
                     "Nalanda",
                     "Patna",
                     "Bhojpur",
                     "Buxar",
                     "Kaimur (Bhabua)",
                     "Rohtas",
                     "Aurangabad",
                     "Gaya",
                     "Nawada",
                     "Jamui",
                     "Jehanabad",
                     "Arwal",
                     "North District",
                     "West District",
                     "South District",
                     "East District",
                     "Tawang",
                     "West Kameng",
                     "East Kameng",
                     "Papum Pare",
                     "Upper Subansiri",
                     "West Siang",
                     "East Siang",
                     "Upper Siang",
                     "Changlang",
                     "Tirap",
                     "Lower Subansiri",
                     "Kurung Kumey",
                     "Dibang Valley",
                     "Lower Dibang Valley",
                     "Lohit",
                     "Anjaw",
                     "Mon",
                     "Mokokchung",
                     "Zunheboto",
                     "Wokha",
                     "Dimapur",
                     "Phek",
                     "Tuensang",
                     "Longleng",
                     "Kiphire",
                     "Kohima",
                     "Peren",
                     "Bishnupur",
                     "Thoubal",
                     "Imphal West",
                     "Imphal East",
                     "Senapati",
                     "Tamenglong",
                     "Churachandpur",
                     "Ukhrul",
                     "Chandel",
                     "Mamit",
                     "Kolasib",
                     "Aizawl",
                     "Champhai",
                     "Serchhip",
                     "Lunglei",
                     "Lawngtlai",
                     "Saiha",
                     "West Tripura",
                     "South Tripura",
                     "Dhalai",
                     "North Tripura",
                     "West Garo Hills",
                     "East Garo Hills",
                     "South Garo Hills",
                     "West Khasi Hills",
                     "Ribhoi",
                     "East Khasi Hills",
                     "Jaintia Hills",
                     "Lakhimpur",
                     "Dhemaji",
                     "Tinsukia",
                     "Dibrugarh",
                     "Sivasagar",
                     "Jorhat",
                     "Golaghat",
                     "Kokrajhar",
                     "Dhubri",
                     "Goalpara",
                     "Barpeta",
                     "Bongaigaon",
                     "Chirang",
                     "Kamrup",
                     "Kamrup Metropolitan",
                     "Nalbari",
                     "Baksa","Karbi Anglong",
                     "Dima Hasao",
                     "Cachar",
                     "Karimganj",
                     "Hailakandi",
                     "Morigaon",
                     "Nagaon",
                     "Sonitpur",
                     "Darrang",
                     "Udalguri",
                     "Darjiling",
                     "Jalpaiguri",
                     "Koch Bihar",
                     "Uttar Dinajpur",
                     "Dakshin Dinajpur",
                     "Maldah",
                     "Murshidabad",
                     "Birbhum",
                     "Nadia",
                     "North Twenty Four Parganas",
                     "Kolkata","South Twenty Four Parganas",
                     "Barddhaman",
                     "Hugli",
                     "Haora",
                     "Bankura",
                     "Puruliya",
                     "Paschim Medinipur",
                     "Purba Medinipur",
                     "Garhwa",
                     "Lohardaga",
                     "Purbi Singhbhum",
                     "Palamu",
                     "Latehar",
                     "Ranchi",
                     "Khunti",
                     "Gumla",
                     "Simdega",
                     "Pashchimi Singhbhum",
                     "Saraikela-Kharsawan",
                     "Chatra",
                     "Kodarma",
                     "Giridih",
                     "Deoghar",
                     "Godda",
                     "Sahibganj",
                     "Pakur",
                     "Dhanbad",
                     "Bokaro",
                     "Hazaribagh",
                     "Ramgarh",
                     "Dumka",
                     "Jamtara",
                     "Baleshwar",
                     "Bhadrak",
                     "Kendrapara",
                     "Jagatsinghapur",
                     "Cuttack",
                     "Jajapur",
                     "Nayagarh",
                     "Khordha",
                     "Puri",
                     "Ganjam",
                     "Gajapati",
                     "Kandhamal",
                     "Baudh",
                     "Subarnapur",
                     "Balangir",
                     "Nuapada","Kalahandi",
                     "Rayagada",
                     "Nabarangapur",
                     "Koraput",
                     "Malkangiri",
                     "Bargarh",
                     "Jharsuguda",
                     "Sambalpur",
                     "Debagarh",
                     "Sundargarh",
                     "Kendujhar",
                     "Mayurbhanj",
                     "Dhenkanal",
                     "Anugul",
                     "Koriya",
                     "Surguja",
                     "Surajpur",
                     "Balrampur",
                     "Jashpur",
                     "Raigarh",
                     "Korba",
                     "Janjgir-Champa",
                     "Bilaspur",
                     "Kabeerdham",
                     "Rajnandgaon",
                     "Durg",
                     "Raipur",
                     "Mahasamund",
                     "Dhamtari",
                     "Balodabazar",
                     "Gariyaband",
                     "Bemetara",
                     "Balod",
                     "Mungeli",
                     "Uttar Bastar Kanker",
                     "Bastar",
                     "Narayanpur",
                     "Dakshin Bastar Dantewada",
                     "Bijapur",
                     "Kondagaon",
                     "Sukama",
                     "Tikamgarh",
                     "Chhatarpur",
                     "Panna",
                     "Satna",
                     "Rewa",
                     "Umaria",
                     "Shahdol",
                     "Anuppur",
                     "Sidhi",
                     "Singrauli",
                     "Sagar",
                     "Damoh",
                     "Vidisha",
                     "Bhopal",
                     "Sehore",
                     "Raisen",
                     "Neemuch",
                     "Mandsaur",
                     "Ratlam",
                     "Ujjain",
                     "Shajapur",
                     "Dewas",
                     "Dhar",
                     "Indore",
                     "Rajgarh",
                     "Jhabua",
                     "Alirajpur",
                     "Katni",
                     "Jabalpur",
                     "Narsimhapur",
                     "Dindori",
                     "Mandla",
                     "Chhindwara",
                     "Seoni",
                     "Balaghat",
                     "Khargone (West Nimar)",
                     "Barwani",
                     "Betul",
                     "Harda",
                     "Hoshangabad",
                     "Khandwa (East Nimar)",
                     "Burhanpur","Sheopur",
                     "Morena",
                     "Bhind",
                     "Gwalior",
                     "Datia",
                     "Shivpuri",
                     "Guna",
                     "Ashoknagar",
                     "Panch Mahals",
                     "Dohad",
                     "Vadodara",
                     "Narmada",
                     "Bharuch",
                     "The Dangs",
                     "Navsari",
                     "Valsad",
                     "Surat",
                     "Tapi",
                     "Mahesana",
                     "Sabar Kantha",
                     "Gandhinagar",
                     "Ahmedabad",
                     "Anand",
                     "Kheda",
                     "Banas Kantha",
                     "Patan",
                     "Kachchh",
                     "Surendranagar",
                     "Rajkot",
                     "Jamnagar",
                     "Porbandar",
                     "Junagadh",
                     "Amreli",
                     "Bhavnagar",
                     "Diu",
                     "Daman",
                     "Dadra & Nagar Haveli",
                     "Thane",
                     "Mumbai Suburban",
                     "Mumbai",
                     "Raigarh",
                     "Ratnagiri",
                     "Sindhudurg",
                     "Pune",
                     "Ahmadnagar",
                     "Solapur",
                     "Satara",
                     "Kolhapur",
                     "Sangli",
                     "Nandurbar",
                     "Dhule",
                     "Jalgaon",
                     "Nashik",
                     "Nanded",
                     "Hingoli",
                     "Parbhani",
                     "Jalna",
                     "Aurangabad",
                     "Bid",
                     "Latur",
                     "Osmanabad",
                     "Buldana",
                     "Akola",
                     "Washim",
                     "Amravati",
                     "Wardha",
                     "Nagpur",
                     "Yavatmal",
                     "Bhandara",
                     "Gondiya",
                     "Gadchiroli",
                     "Chandrapur",
                     "Srikakulam",
                     "Vizianagaram",
                     "Visakhapatnam",
                     "East Godavari",
                     "West Godavari",
                     "Krishna",
                     "Guntur",
                     "Prakasam",
                     "Sri Potti Sriramulu Nellore",
                     "Y.S.R. (Cuddapah)",
                     "Kurnool",
                     "Anantapur",
                     "Chittoor",
                     "Uttara Kannada",
                     "Udupi","Dakshina Kannada",
                     "Shimoga","Chikmagalur",
                     "Hassan","Kodagu",
                     "Tumkur",
                     "Bangalore","Mandya",
                     "Mysore","Chamarajanagar",
                     "Kolar","Chikkaballapura",
                     "Bangalore (Rural)",
                     "Ramanagara","Belgaum",
                     "Bagalkot","Bijapur",
                     "Bidar","Raichur","Koppal",
                     "Gadag",
                     "Dharwad","Haveri",
                     "Bellary","Chitradurga",
                     "Davanagere","Gulbarga","Yadgir",
                     "North Goa","South Goa","Lakshadweep",
                     "Kasaragod","Kannur","Wayanad","Kozhikode",
                     "Malappuram","Palakkad","Thrissur",
                     "Ernakulam","Idukki","Kottayam",
                     "Alappuzha",
                     "Pathanamthitta","Kollam",
                     "Thiruvananthapuram",
                     "Thiruvallur","Chennai",
                     "Kancheepuram","Vellore","Tiruvannamalai",
                     "Viluppuram","Cuddalore","Karur",
                     "Tiruchirappalli","Perambalur","Ariyalur",
                     "Nagapattinam","Thiruvarur","Thanjavur",
                     "Pudukkottai","Dindigul","Sivaganga","Madurai",
                     "Theni","Virudhunagar",
                     "Ramanathapuram","Thoothukkudi","Tirunelveli",
                     "Kanniyakumari","Salem","Namakka",
                     "Erode","The Nilgiris","Dharmapuri","Krishnagiri",
                     "Coimbatore","Tiruppur","Yanam",
                     "Puducherry","Mahe","Karaikal","Nicobars",
                     "North & Middle Andaman","South Andaman",
                     "Adilabad","Nizamabad","Medak","Hyderabad",
                     "Rangareddy","Mahbubnagar","Karimnagar",
                     "Nalgonda",
                     "Warangal",
                     "Khammam"
                     )

  districts <- data.table(Vdistrict, District_Names )

#+END_SRC


#+NAME: Counting the number of observation in each District
#+BEGIN_SRC R :session plfs :results value silent :exports results 
  merge(a2,districts,by="Vdistrict")->a3
  a3[,No_of_observation_for_each_district :=.N, by = .(District_Names)]
#+END_SRC


#+Name: District Wise distribution(for districts with more than 12 observations.)
#+Begin_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[ V5==2 & No_of_observation_for_each_district > 12,.(No_of_observation = .N) ,by = .(State_Names,District_Names)]
#+END_SRC
## District Wise distribution(for districts with more than 12 observations.)
#+RESULTS: District Wise distribution(for districts with more than 12 observations.)
| State_Names      | District_Names             | No_of_observation |
|------------------+----------------------------+-------------------|
| Jammu & Kashmir  | Kupwara                    |                 2 |
| Jammu & Kashmir  | Baramula                   |                 6 |
| Jammu & Kashmir  | Srinagar                   |                34 |
| Jammu & Kashmir  | Anantnag                   |                 3 |
| Jammu & Kashmir  | Jammu                      |                19 |
| Himachal Pradesh | Kangra                     |                 2 |
| Punjab           | Ludhiana                   |                16 |
| Punjab           | Moga                       |                 2 |
| Chandigarh       | Chandigarh                 |                17 |
| Haryana          | Gurgaon                    |                15 |
| Haryana          | Faridabad                  |                10 |
| Delhi            | North West Delhi           |                37 |
| Rajasthan        | Jaipur                     |                12 |
| Rajasthan        | Jodhpur                    |                10 |
| Rajasthan        | Ajmer                      |                11 |
| Uttar Pradesh    | Rampur                     |                 7 |
| Uttar Pradesh    | Ghaziabad                  |                10 |
| Uttar Pradesh    | Kanpur Nagar               |                 9 |
| Bihar            | Aurangabad                 |                 1 |
| Sikkim           | East District              |                16 |
| Nagaland         | Dimapur                    |                 8 |
| Manipur          | Bishnupur                  |                 7 |
| Manipur          | Thoubal                    |                 8 |
| Manipur          | Imphal West                |                20 |
| Mizoram          | Aizawl                     |                45 |
| Tripura          | West Tripura               |                35 |
| Tripura          | South Tripura              |                 1 |
| Tripura          | North Tripura              |                 5 |
| Meghalaya        | West Garo Hills            |                 5 |
| Meghalaya        | East Khasi Hills           |                16 |
| Meghalaya        | Jaintia Hills              |                 1 |
| Assam            | Tinsukia                   |                 3 |
| Assam            | Dibrugarh                  |                 5 |
| Assam            | Cachar                     |                 7 |
| West Bengal      | Murshidabad                |                 4 |
| West Bengal      | Barddhaman                 |                11 |
| West Bengal      | North Twenty Four Parganas |                43 |
| West Bengal      | Hugli                      |                 9 |
| West Bengal      | Kolkata                    |                27 |
| Jharkhand        | Dhanbad                    |                11 |
| Jharkhand        | Bokaro                     |                12 |
| Jharkhand        | Ranchi                     |                10 |
| Odisha           | Cuttack                    |                 5 |
| Chhattisgarh     | Raigarh                    |                 2 |
| Chhattisgarh     | Durg                       |                13 |
| Madhya Pradesh   | Indore                     |                16 |
| Gujarat          | Kachchh                    |                 5 |
| Gujarat          | Ahmedabad                  |                30 |
| Gujarat          | Rajkot                     |                 9 |
| Gujarat          | Jamnagar                   |                 8 |
| Gujarat          | Bhavnagar                  |                 8 |
| Gujarat          | Vadodara                   |                13 |
| Maharashtra      | Buldana                    |                 3 |
| Maharashtra      | Aurangabad                 |                10 |
| Maharashtra      | Nashik                     |                13 |
| Maharashtra      | Thane                      |                60 |
| Maharashtra      | Mumbai Suburban            |                77 |
| Maharashtra      | Raigarh                    |                12 |
| Maharashtra      | Pune                       |                24 |
| Maharashtra      | Solapur                    |                 7 |
| Andhra Pradesh   | Srikakulam                 |                 1 |
| Andhra Pradesh   | Visakhapatnam              |                22 |
| Andhra Pradesh   | East Godavari              |                13 |
| Andhra Pradesh   | Guntur                     |                 9 |
| Andhra Pradesh   | Kurnool                    |                10 |
| Andhra Pradesh   | Chittoor                   |                 9 |
| Karnataka        | Bangalore                  |                36 |
| Karnataka        | Gulbarga                   |                 6 |
| Goa              | South Goa                  |                10 |
| Kerala           | Kozhikode                  |                15 |
| Kerala           | Palakkad                   |                 1 |
| Kerala           | Thrissur                   |                 8 |
| Kerala           | Ernakulam                  |                43 |
| Kerala           | Idukki                     |                 2 |
| Kerala           | Kottayam                   |                12 |
| Kerala           | Alappuzha                  |                 9 |
| Kerala           | Kollam                     |                11 |
| Kerala           | Thiruvananthapuram         |                15 |
| Tamil Nadu       | Thiruvallur                |                19 |
| Tamil Nadu       | Chennai                    |                21 |
| Tamil Nadu       | Kancheepuram               |                24 |
| Tamil Nadu       | Vellore                    |                 7 |
| Tamil Nadu       | Tiruvannamalai             |                 3 |
| Tamil Nadu       | Viluppuram                 |                 4 |
| Tamil Nadu       | Karur                      |                10 |
| Tamil Nadu       | Tiruchirappalli            |                 7 |
| Tamil Nadu       | Thoothukkudi               |                10 |
| Tamil Nadu       | Tirunelveli                |                11 |
| Tamil Nadu       | Coimbatore                 |                14 |
| Puducherry       | Puducherry                 |                18 |
| A & N Island     | South Andaman              |                19 |
| Telangana        | Karimnagar                 |                 5 |
| Telangana        | Hyderabad                  |                49 |
| Telangana        | Mahbubnagar                |                 6 |
| Telangana        | Nalgonda                   |                12 |

*** All types of Education Level
**** General Education Level
#+BEGIN_SRC R :session plfs :results value silent :exports results 
  GeneralEducation <-data.table( V22 = c(1,2,3,4,5,6,7,8,10,11,12,13),
                                Education_Level = c("notliterate",
                                                    "literate without formal schooling",
                                                    "TLC", "others",
                                                    "literate-below primary",
                                                    " primary", "middle",
                                                    "secondary",
                                                    "higher secondary",
                                                    "diploma/certificate course",
                                                    "graduate",
                                                    "postgraduate & above"
                                                    )
                                )

  merge(a3,GeneralEducation,by = "V22")-> a3

#+END_SRC
#+Name:General Education Level
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==2,Per_Gen_Edu := round(((.N/2259)*100),2),by = .(Code = V22)] 
  a3[V5==2,.(N = .N ,Percentage = round(((.N/2259)*100),2)),by = .(Code = V22,Education_Level)]
#+End_SRC
#+RESULTS: General Education Level
| Code | Education_Level            |   N | Percentage |
|------+----------------------------+-----+------------|
|    1 | notliterate                | 161 |       7.13 |
|    4 | others                     |   2 |       0.09 |
|    5 | literate-below primary     | 122 |        5.4 |
|    6 | primary                    | 309 |      13.68 |
|    7 | middle                     | 793 |       35.1 |
|    8 | secondary                  | 513 |      22.71 |
|   10 | higher secondary           | 228 |      10.09 |
|   11 | diploma/certificate course |  28 |       1.24 |
|   12 | graduate                   |  95 |       4.21 |
|   13 | postgraduate & above       |   8 |       0.35 |
**** Technical Education Level
#+Name: Technical Education Level
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==2,.(Percentage = round(((.N/2259)*100),2)), by = list( Technichal_Education = V23)]
#+END_SRC
#+CAPTION: Proportion of people with technical education who are engaged in on demand based application wrok.
#+RESULTS: Technical Education Level
| Technichal_Education | Percentage |
|----------------------+------------|
|                    1 |      98.58 |
|                    8 |       0.93 |
|                   11 |       0.31 |
|                    3 |       0.09 |
|                   16 |       0.04 |
|                    6 |       0.04 |
## Technical Education Code 1 implies no technical education.
**** Years of Formal Education
#+Name: Formal Education Years
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[,Edu_Yr_N := .N,by = .(Code = V24)] 
  a3[V5==2,Per_Edu_Yr := round(((.N/2259)*100),2),by = .(Code = V24)] 
  a3[V5==2,.(N = .N ,Percentage = round(((.N/2259)*100),2)),by = .(No_of_Years = V24,Education_Level)]
#+END_SRC
#+RESULTS: Formal Education Years
| No_of_Years | Education_Level            |   N | Percentage |
|-------------+----------------------------+-----+------------|
|           0 | notliterate                | 161 |       7.13 |
|           0 | others                     |   2 |       0.09 |
|           3 | literate-below primary     |  32 |       1.42 |
|           4 | literate-below primary     |  64 |       2.83 |
|           2 | literate-below primary     |  21 |       0.93 |
|           1 | literate-below primary     |   4 |       0.18 |
|           0 | literate-below primary     |   1 |       0.04 |
|           7 | primary                    |  73 |       3.23 |
|           5 | primary                    | 126 |       5.58 |
|           6 | primary                    |  73 |       3.23 |
|           8 | primary                    |  11 |       0.49 |
|           4 | primary                    |  23 |       1.02 |
|           3 | primary                    |   2 |       0.09 |
|           9 | primary                    |   1 |       0.04 |
|          10 | middle                     |  86 |       3.81 |
|           8 | middle                     | 350 |      15.49 |
|           9 | middle                     | 271 |         12 |
|           7 | middle                     |  74 |       3.28 |
|           6 | middle                     |  12 |       0.53 |
|          12 | secondary                  |  26 |       1.15 |
|          10 | secondary                  | 414 |      18.33 |
|          11 | secondary                  |  39 |       1.73 |
|           9 | secondary                  |  20 |       0.89 |
|           8 | secondary                  |  11 |       0.49 |
|          15 | secondary                  |   1 |       0.04 |
|          14 | secondary                  |   1 |       0.04 |
|          13 | secondary                  |   1 |       0.04 |
|          12 | higher secondary           | 197 |       8.72 |
|          13 | higher secondary           |  14 |       0.62 |
|          14 | higher secondary           |   8 |       0.35 |
|          11 | higher secondary           |   4 |       0.18 |
|          10 | higher secondary           |   3 |       0.13 |
|          15 | higher secondary           |   1 |       0.04 |
|          16 | higher secondary           |   1 |       0.04 |
|          14 | diploma/certificate course |   6 |       0.27 |
|          15 | diploma/certificate course |   4 |       0.18 |
|          12 | diploma/certificate course |  10 |       0.44 |
|          13 | diploma/certificate course |   7 |       0.31 |
|          11 | diploma/certificate course |   1 |       0.04 |
|          15 | graduate                   |  84 |       3.72 |
|          17 | graduate                   |   3 |       0.13 |
|          16 | graduate                   |   5 |       0.22 |
|          20 | graduate                   |   1 |       0.04 |
|          18 | graduate                   |   1 |       0.04 |
|          14 | graduate                   |   1 |       0.04 |
|          17 | postgraduate & above       |   8 |       0.35 |

**** Graph of education level of population under study
#+Name: graph1
#+BEGIN_SRC R :session plfs :results output graphics :exports results :file bmi1.png :width 825 :height 1050 :fonts serif
a3[V5==2]-> a4
  s <- ggplot(a4, aes(V24))
  s + geom_bar(aes(fill=Education_Level)) +
    labs(y = "No. of Observation", x ="Years of Education") +
    ggtitle("Education Level of the Population Under Study") + 
    theme(plot.title=element_text(family = "Helvetica",face = "bold", size = (13)))

#+END_SRC
#+Caption:Education Level of the Population Under Study
#+RESULTS: graph1
[[file:bmi1.png]]

*** Type of training(if any)
#+Name: Training
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
a3[V5==2, .(.N, Percent=round(((.N/2259)*100),2)), keyby=V26]
#+END_SRC
#+RESULTS: Training
| V26 |    N | Percent |
|-----+------+---------|
| nil |   57 |    2.52 |
|   1 |   50 |    2.21 |
|   2 |   16 |    0.71 |
|   3 |  214 |    9.47 |
|   4 |  153 |    6.77 |
|   5 |   50 |    2.21 |
|   6 | 1719 |    76.1 |
#yes: received formal vocational/technical training-1
#received vocational/technical training other than formal vocational/technical training: hereditary-2, 
#self-leanring-3, 
#learning on the job-4, 
#others –5;
#did not receive any vocational/technical training -6.
**** Field of training
#+Name: Field of Training
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==2, .(.N, Percent = round(((.N/2259)*100),2)), keyby=V28]
#+END_SRC
#+Caption: Field of training
#+RESULTS: Field of Training
| V28 |    N | Percent |
|-----+------+---------|
| nil | 2209 |   97.79 |
|   5 |   22 |    0.97 |
|   9 |    1 |    0.04 |
|  11 |    1 |    0.04 |
|  13 |    5 |    0.22 |
|  15 |    7 |    0.31 |
|  17 |    2 |    0.09 |
|  99 |   12 |    0.53 |
## 05 - automotive, 
##9 - electrical power and electronics,
##11 - hospitality, 13 - IT-ITes, 
##15 -  mechanical engineering- capital goods,strategic manufacturing,
##17-office and business related work ,
##99- other.

*** Status code in case of Principal Activity 
#+BEGIN_SRC R :session plfs :results value silent :exports results 
  Status <- data.table( V32 = c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
                       status = c("worked in hh enterprise(self-employed):own account worker",
                                  "employer",
                                  "worked as helper in hh enterprise(unpaid family worker)",
                                  "worked as regular salaried/wage employee",
                                  "worked as casual wage labour:in public works",
                                  "in other types of work",
                                  "did not work but was seeking and/or available for work",
                                  " attended educational institution",
                                  "attended domestic duties only",
                                  "attended domestic duties and engaged in free collection of goods for hh use",
                                  "rentiers,pensioners,remittance recipients,etc",
                                  "not able to work due to disability",
                                  "others (including begging,prostitution,etc.)"
                                  ))
  merge(a3,Status,by="V32")-> a3
#+END_SRC

#+Name: Status Code(Pricipal Activity)
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==2,.(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V32,status)]

#+END_SRC
#+RESULTS: Status Code(Pricipal Activity)
| V32 | status                                                    |    N | Percent |
|-----+-----------------------------------------------------------+------+---------|
|  11 | worked in hh enterprise(self-employed):own account worker | 1078 |   47.72 |
|  12 | employer                                                  |   11 |    0.49 |
|  21 | worked as helper in hh enterprise(unpaid family worker)   |   18 |     0.8 |
|  31 | worked as regular salaried/wage employee                  |  897 |   39.71 |
|  51 | in other types of work                                    |  255 |   11.29 |

*** Location of Work
**** In Urban Sector
#+BEGIN_SRC R :session plfs :results value silent :exports results 
  WorkLoc <- data.table( 
    V36 = c(10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,99),
    work_location = c( "workplace in rural areas and located in-own dwelling unit",
                      "structure attached to own dwelling unit", 
                      "open area adjacent to own dwelling unit",
                      " detached structure adjacent to own dwelling unit",
                      " own enterprise/unit/office/shop but away from own dwelling",
                      "employer’s dwelling unit",
                      "employer’s enterprise/unit/office/shop but outside employer’s dwelling",
                      " street with fixed location",
                      " construction site",
                      " others(rural) ",
                      "workplace in urban areas and located in -own dwelling unit",
                      " structure attached to own dwelling unit",
                      " open area adjacent to own dwelling unit",
                      " detached structure adjacent to own dwelling unit",
                      "own enterprise/unit/office/shop but away from own dwelling",
                      " employer’s dwelling unit",
                      " employer’s enterprise/unit/office/shop but outside employer’s dwelling",
                      " street with fixed location",
                      " construction site",
                      " others(urban)", 
                      "no fixed workplace"))

  merge(a3,WorkLoc,by ="V36") -> a3
#+END_SRC
#+NAME: Workplace Location Urban
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==2,.(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V36,work_location)]
#+END_SRC
#+RESULTS: Workplace Location Urban
| V36 | work_location                                                          |    N | Percent |
|-----+------------------------------------------------------------------------+------+---------|
|  10 | workplace in rural areas and located in-own dwelling unit              |    5 |    0.22 |
|  11 | structure attached to own dwelling unit                                |    1 |    0.04 |
|  14 | own enterprise/unit/office/shop but away from own dwelling             |    2 |    0.09 |
|  15 | employer’s dwelling unit                                               |    1 |    0.04 |
|  16 | employer’s enterprise/unit/office/shop but outside employer’s dwelling |    1 |    0.04 |
|  17 | street with fixed location                                             |    5 |    0.22 |
|  19 | others(rural)                                                          |   17 |    0.75 |
|  20 | workplace in urban areas and located in -own dwelling unit             |   47 |    2.08 |
|  21 | structure attached to own dwelling unit                                |   17 |    0.75 |
|  22 | open area adjacent to own dwelling unit                                |   12 |    0.53 |
|  23 | detached structure adjacent to own dwelling unit                       |    8 |    0.35 |
|  24 | own enterprise/unit/office/shop but away from own dwelling             |   59 |    2.61 |
|  25 | employer’s dwelling unit                                               |   49 |    2.17 |
|  26 | employer’s enterprise/unit/office/shop but outside employer’s dwelling |  443 |   19.61 |
|  27 | street with fixed location                                             |  206 |    9.12 |
|  28 | construction site                                                      |    6 |    0.27 |
|  29 | others(urban)                                                          |  306 |   13.55 |
|  99 | no fixed workplace                                                     | 1074 |   47.54 |
## This observation make me doubt my choice of only analysing urban spaces.
**** In Rural Sector
#+NAME: Workplace Location Rural
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  a3[V5==1,.(.N, Percent = round(((.N/2001)*100),2)), keyby=.(V36,work_location)]
#+END_SRC
#+RESULTS: Workplace Location Rural
| V36 | work_location                                                          |   N | Percent |
|-----+------------------------------------------------------------------------+-----+---------|
|  10 | workplace in rural areas and located in-own dwelling unit              |  60 |       3 |
|  11 | structure attached to own dwelling unit                                |  12 |     0.6 |
|  12 | open area adjacent to own dwelling unit                                |   9 |    0.45 |
|  13 | detached structure adjacent to own dwelling unit                       |  11 |    0.55 |
|  14 | own enterprise/unit/office/shop but away from own dwelling             |  24 |     1.2 |
|  15 | employer’s dwelling unit                                               |  34 |     1.7 |
|  16 | employer’s enterprise/unit/office/shop but outside employer’s dwelling | 256 |   12.79 |
|  17 | street with fixed location                                             | 138 |     6.9 |
|  18 | construction site                                                      |  13 |    0.65 |
|  19 | others(rural)                                                          | 493 |   24.64 |
|  20 | workplace in urban areas and located in -own dwelling unit             |   8 |     0.4 |
|  22 | open area adjacent to own dwelling unit                                |   1 |    0.05 |
|  23 | detached structure adjacent to own dwelling unit                       |   1 |    0.05 |
|  24 | own enterprise/unit/office/shop but away from own dwelling             |   9 |    0.45 |
|  25 | employer’s dwelling unit                                               |  13 |    0.65 |
|  26 | employer’s enterprise/unit/office/shop but outside employer’s dwelling | 113 |    5.65 |
|  27 | street with fixed location                                             |  40 |       2 |
|  28 | construction site                                                      |   3 |    0.15 |
|  29 | others(urban)                                                          |  53 |    2.65 |
|  99 | no fixed workplace                                                     | 710 |   35.48 |

*** Enterprise Type
#+NAME:Enterprise Type
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  Enterprise = data.table( V37 = c(1,2,3,4,5,6,7,8,10,11,12,19),
                          enterprise = c("proprietary-male",
                                         "proprietary-female",
                                         " partnership-with members from same household.",
                                         "partnership- with members from different household",
                                         " Government/local body",
                                         " Public Sector Enterprises",
                                         " Autonomous Bodies",
                                         " Public/Private limited company",
                                         " Co-operative societies",
                                         " trust/other non-profit institutions ",
                                         " employer’s households",
                                         " others"))

  merge(a3,Enterprise,by = "V37")-> a3

  a3[V5==2,.(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V37,enterprise)]
#+END_SRC
#+RESULTS: Enterprise Type
| V37 | enterprise                                         |    N | Percent |
|-----+----------------------------------------------------+------+---------|
|   1 | proprietary-male                                   | 1872 |   82.87 |
|   2 | proprietary-female                                 |    4 |    0.18 |
|   3 | partnership-with members from same household.      |    4 |    0.18 |
|   4 | partnership- with members from different household |   14 |    0.62 |
|   5 | Government/local body                              |   50 |    2.21 |
|   6 | Public Sector Enterprises                          |    7 |    0.31 |
|   7 | Autonomous Bodies                                  |   14 |    0.62 |
|   8 | Public/Private limited company                     |  100 |    4.43 |
|  10 | Co-operative societies                             |    1 |    0.04 |
|  11 | trust/other non-profit institutions                |    1 |    0.04 |
|  19 | others                                             |  192 |     8.5 |

**** No. of workers in the enterprise
#+NAME:No. of workers in the enterprise
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  Worker_N <- data.table(V38 = c(1,2,3,4,9),
                         No_of_Worker_in_enteprise = c(
                           "< 6",
                           " 6 =< 10",
                           " 10 =< 20",
                           " 20 < ",
                           "not known"
                         )
                         )
  merge(a3,Worker_N,by="V38")->a3

  a3[V5==2, .(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V38,No_of_Worker_in_enteprise)]
#+END_SRC
#+RESULTS: No. of workers in the enterprise
| V38 | No_of_Worker_in_enteprise |    N | Percent |
|-----+---------------------------+------+---------|
|   1 | < 6                       | 1836 |   81.27 |
|   2 | 6 =< 10                   |   93 |    4.12 |
|   3 | 10 =< 20                  |   38 |    1.68 |
|   4 | 20 <                      |   85 |    3.76 |
|   9 | not known                 |  207 |    9.16 |
*** Type of Contract
#+NAME:Type of Contract
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  Contract <- data.table(V39 =c(1,2,3,4),
                         contract_type = c(
                           "no written job contract",
                           "written job contract: <=1 year",
                           " more than 1 year to 3 years",
                           " more than 3 years"
                         )
                         )

  merge(a3,Contract,by="V39")-> a3
  a3[V5==2, .(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V39,contract_type)]
#+END_SRC
#+RESULTS: Type of Contract
| V39 | contract_type                  |    N | Percent |
|-----+--------------------------------+------+---------|
|   1 | no written job contract        | 1096 |   48.52 |
|   2 | written job contract: <=1 year |   22 |    0.97 |
|   3 | more than 1 year to 3 years    |    9 |     0.4 |
|   4 | more than 3 years              |   25 |    1.11 |
*** Paid Leave Eligibility
#+Name:Eligible for paid leaves
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  Eligibility <- data.table(V40 = c(1,2,NA),
                            Eligible_for_paid_leave = c( "Yes"," No","NA"))
  merge(a3,Eligibility,by="V40",all = TRUE) -> a3
  a3[V5==2, .(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V40, Eligible_for_paid_leave)]
#+END_SRC
#+RESULTS: Eligible for paid leaves
| V40 | Eligible_for_paid_leave |    N | Percent |
|-----+-------------------------+------+---------|
|   1 | Yes                     |  138 |    6.11 |
|   2 | No                      | 1014 |   44.89 |

*** Social Security Benefit
#+NAME:Social Security Benefit
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  SS <- data.table(V41 = 
                     c(1,2,3,4,5,6,7,8,9,NA), 
                   social_security_benefit = c(
                     "eligible for: only PF/ pension",
                     "only gratuity",
                     " only health care & maternity benefits",
                     " only PF/ pension and gratuity",
                     " only PF/ pension and health care & maternity benefits",
                     " only gratuity and health care & maternity benefits", 
                     "PF/ pension, gratuity, health care & maternity benefits",
                     " not eligible for any of above social security benefits",
                     " not known",
                     "NA" )
                   )
  merge(a3,SS,by="V41")-> a4
  a4[V5==2, .(.N, Percent = round(((.N/2259)*100),2)), keyby=.(V41,social_security_benefit)]
#+END_SRC
#+RESULTS: Social Security Benefit
| V41 | social_security_benefit                                 |   N | Percent |
|-----+---------------------------------------------------------+-----+---------|
|   1 | eligible for: only PF/ pension                          |  19 |    0.84 |
|   2 | only gratuity                                           |   3 |    0.13 |
|   3 | only health care & maternity benefits                   |   4 |    0.18 |
|   4 | only PF/ pension and gratuity                           |   9 |     0.4 |
|   5 | only PF/ pension and health care & maternity benefits   |  10 |    0.44 |
|   6 | only gratuity and health care & maternity benefits      |   3 |    0.13 |
|   7 | PF/ pension, gratuity, health care & maternity benefits |  24 |    1.06 |
|   8 | not eligible for any of above social security benefits  | 928 |   41.08 |
|   9 | not known                                               | 152 |    6.73 |

** Relevant Subsidiary Activity Status
#+Name: Relevant Subsidiary Activity
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  D[V35 == 1]->F  # 14456 observation
  F[V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> F
  F[V5==2,.N,by = .(V43,V44)]-> F1
  N1 <- data.table(V43 = c(49231,49224,49223,49219,56104,49232),
                   NIC_code_discription = c(
                     "Motorised Freight transport",
                     "taxi operations",
                     "rental of private cars with drivers",
                     "urban&suburban passenger transport..",
                     "Restaurant & barfood activities..",
                     "Non Motorised Freight Transport"
                   ))
  N2<- data.table(V44 = c(832,933,512),
                  NCO_Code_Description_2004=c("MotorVehicleDrivers",
                                              "Trans Labour & FreightHandlers",
                                              "HouseKeeping&Rest ServicesWorkers"
                                              ))
  merge(F1,N1,by = "V43") -> F1
  merge(F1,N2,by = "V44") -> F1

#+END_SRC
#+RESULTS: Relevant Subsidiary Activity
| V44 |   V43 |  N | NIC_code_discription                 | NCO_Code_Description_2004      |
|-----+-------+----+--------------------------------------+--------------------------------|
| 832 | 49219 |  6 | urban&suburban passenger transport.. | MotorVehicleDrivers            |
| 832 | 49223 |  4 | rental of private cars with drivers  | MotorVehicleDrivers            |
| 832 | 49224 | 11 | taxi operations                      | MotorVehicleDrivers            |
| 832 | 49231 |  9 | Motorised Freight transport          | MotorVehicleDrivers            |
| 832 | 49232 |  2 | Non Motorised Freight Transport      | MotorVehicleDrivers            |
| 933 | 49219 |  1 | urban&suburban passenger transport.. | Trans Labour & FreightHandlers |
| 933 | 49232 |  3 | Non Motorised Freight Transport      | Trans Labour & FreightHandlers |
*** Status Code of Subsidiary Activity Status
#+NAME:S1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  Status <- data.table( V42 = 
                          c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
                       status = c("worked in h.h. enterprise (self-employed): own account worker",
                                  "employer",
                                  "worked as helper in h.h. enterprise (unpaid family worker)",
                                  " worked as regular salaried/ wage employee",
                                  "worked as casual wage labour: in public works",
                                  "in other types of work",
                                  "did not work but was seeking and/or available for work",
                                  " attended educational institution",
                                  "attended domestic duties only",
                                  "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
                                  "rentiers, pensioners , remittance recipients, etc",
                                  "not able to work due to disability",
                                  " others (including begging, prostitution, etc.)"
                                  )
                       )
  merge(F,Status,by ="V42")-> F
  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V42,status)]

#+END_SRC
#+RESULTS: S1
| V42 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 23 |   60.53 |
|  12 | employer                                                      |  1 |    2.63 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  2 |    5.26 |
|  31 | worked as regular salaried/ wage employee                     |  5 |   13.16 |
|  51 | in other types of work                                        |  7 |   18.42 |

*** Location of Work of Subsidiary Activity
#+NAME:S2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  WorkLocS <- data.table( 
    V45 = c(10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,99),
    work_location =
      c("workplace in rural areas and located in-own dwelling unit",
        "structure attached to own dwelling unit", 
        "open area adjacent to own dwelling unit",
        "detached structure adjacent to own dwelling unit",
        "own enterprise/unit/office/shop but away from own dwelling",
        "employer’s dwelling unit",
        "employer’s enterprise/unit/office/shop but outside employer’s dwelling",
        "street with fixed location",
        "construction site",
        "others(rural) ",
        "workplace in urban areas and located in -own dwelling unit",
        "structure attached to own dwelling unit",
        "open area adjacent to own dwelling unit",
        "detached structure adjacent to own dwelling unit",
        "own enterprise/unit/office/shop but away from own dwelling",
        "employer’s dwelling unit",
        "employer’s enterprise/unit/office/shop but outside employer’s dwelling",
        "street with fixed location",
        "construction site",
        "others(urban)", 
        "no fixed workplace"))
  merge(F,WorkLocS,by ="V45") -> F2
  F2[V5==2,.(.N, Percent = round(((.N/38)*100),2)), keyby=.(V45,work_location)]


#+END_SRC 
#+RESULTS: S2
| V45 | work_location                                                          |  N | Percent |
|-----+------------------------------------------------------------------------+----+---------|
|  20 | workplace in urban areas and located in -own dwelling unit             |  3 |    7.89 |
|  21 | structure attached to own dwelling unit                                |  1 |    2.63 |
|  22 | open area adjacent to own dwelling unit                                |  1 |    2.63 |
|  25 | employer’s dwelling unit                                               |  1 |    2.63 |
|  26 | employer’s enterprise/unit/office/shop but outside employer’s dwelling |  9 |   23.68 |
|  27 | street with fixed location                                             |  1 |    2.63 |
|  29 | others(urban)                                                          |  6 |   15.79 |
|  99 | no fixed workplace                                                     | 16 |   42.11 |
*** Enterprise Type 
#+NAME:S3
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
EnterpriseS = data.table( V46 = c(1,2,3,4,5,6,7,8,10,11,12,19),
                          enterprise = c("proprietary-male",
                                         "proprietary-female",
                                         " partnership-with members from same household.",
                                         "partnership- with members from different household",
                                         " Government/local body",
                                         " Public Sector Enterprises",
                                         " Autonomous Bodies",
                                         " Public/Private limited company",
                                         " Co-operative societies",
                                         " trust/other non-profit institutions ",
                                         " employer’s households",
                                         " others"))

  merge(F,EnterpriseS,by = "V46")-> F

  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V46,enterprise)]
#+END_SRC
#+RESULTS: S3
| V46 | enterprise       |  N | Percent |
|-----+------------------+----+---------|
|   1 | proprietary-male | 37 |   97.37 |
|  19 | others           |  1 |    2.63 |

**** No. of workers
#+NAME:S4
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
Worker_NS <- data.table(V47 = c(1,2,3,4,9),
                         No_of_Worker_in_enteprise = c(
                           "< 6",
                           " 6 =< 10",
                           " 10 =< 20",
                           " 20 < ",
                           "not known"
                         )
                         )
  merge(F,Worker_NS,by="V47")->F

  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V47,No_of_Worker_in_enteprise)]
  
#+END_SRC
#+RESULTS: S4
| V47 | No_of_Worker_in_enteprise |  N | Percent |
|-----+---------------------------+----+---------|
|   1 | < 6                       | 33 |   86.84 |
|   2 | 6 =< 10                   |  3 |    7.89 |
|   9 | not known                 |  2 |    5.26 |

*** Type of Contract
#+NAME:S5
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  ContractS <- data.table(
    V48 =c(1,2,3,4,NA),
    contract_type = c(
      "no written job contract",
      "written job contract: <=1 year",
      " more than 1 year to 3 years",
      " more than 3 years",
      "NA"
    )
  )

  merge(F,ContractS,by="V48")-> F

  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V48,contract_type)]

#+END_SRC
#+RESULTS: S5
| V48 | contract_type           |  N | Percent |
|-----+-------------------------+----+---------|
| nil | NA                      | 26 |   68.42 |
| 1   | no written job contract | 12 |   31.58 |
*** Eligibility of Paid Leave

#+NAME:S6
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 EligibilityS <- data.table(V49 = c(1,2,NA),
                            Eligible_for_paid_leave = c( "Yes"," No","NA"))
  merge(F,EligibilityS,by="V49",all = TRUE) -> F
  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V49, Eligible_for_paid_leave)]
#+END_SRC
#+RESULTS: S6
| V49 | Eligible_for_paid_leave |  N | Percent |
|-----+-------------------------+----+---------|
| nil | NA                      | 26 |   68.42 |
|   1 | Yes                     |  1 |    2.63 |
|   2 | No                      | 11 |   28.95 |
*** Social Security benefit
#+NAME:S7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  SSB <- data.table(V50 = 
      c(1,2,3,4,5,6,7,8,9,NA), 
      social_security_benefit = c(
    "eligible for: only PF/ pension",
    "only gratuity",
    " only health care & maternity benefits",
    " only PF/ pension and gratuity",
    " only PF/ pension and health care & maternity benefits",
    " only gratuity and health care & maternity benefits", 
    "PF/ pension, gratuity, health care & maternity benefits",
    " not eligible for any of above social security benefits",
    " not known",
    "NA" )
  )
  merge(F,SSB,by="V50")-> F
  F[V5==2, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V50,social_security_benefit)]
#+END_SRC
#+RESULTS: S7
| V50 | social_security_benefit                                |  N | Percent |
|-----+--------------------------------------------------------+----+---------|
| nil | NA                                                     | 26 |   68.42 |
|   8 | not eligible for any of above social security benefits | 11 |   28.95 |
|   9 | not known                                              |  1 |    2.63 |

** Analysing Activity status on Day 7
##Only have two digit NIC code classification

## Not sure if Activity 1 and Principal activity are same, but according to the major time criterion followed in the survey they should be same.
*** Activity1
**** Status Code of A1 on Day 6 with NIC Classification 49 & 56
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |

**** NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity.
## V52- NIC code of Activity 1 on day 7
#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |
## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis

**** Status of activity 1 for the data with relevant principal activity.
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |
**** Hours Actually Worked on Day 7 for A1
#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |
**** Wages earned for A1 on Day 7
#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.
*** Activity 2
****  Status Code of A2 on Day 6 with NIC Classification 49 & 56
#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V65 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 23 |   60.53 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  6 |   15.79 |
|  51 | in other types of work                                        |  3 |    7.89 |
****  NIC code distribution for Activity 2 on DAY 7 for the data with relevant Subsidiary activity
#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |
**** Hours Actually Worked for A2 on day 7
#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |

### Table heading needs to be corrected
*** Total Hours Worked on Day 7
#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |
** Day 6
Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:D6A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V62 %in% c(49,56)] -> d6

 Statusd6 <- data.table( V61 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(d6,Statusd6,by ="V61")-> d6
  d6[,.(.N,Percent=round(((.N/9862)*100),2)), keyby=.(V61,status)]

#+END_SRC
#+CAPTION:Status code of activity one on day 6
#+RESULTS: D6A1
| V61 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4331 |   43.92 |
|  12 | employer                                                      |  193 |    1.96 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  432 |    4.38 |
|  31 | worked as regular salaried/ wage employee                     | 3439 |   34.87 |
|  51 | in other types of work                                        |  872 |    8.84 |

#+Name: Checking if Activity 1 and Prinicipal activity have some similarity on day 6.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
t11[,.N,keyby=V62]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status day 6.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity on day 6.
| V62 |    N |
|-----+------|
| nil |   95 |
|   1 |    3 |
|  10 |    1 |
|  30 |    1 |
|  47 |    4 |
|  49 | 2140 |
|  52 |    2 |
|  56 |    5 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    2 |
## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1D6
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,Statusd6,by ="V61")-> t16
  t16[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V61,status)]
#+END_SRC
#+RESULTS: A1D6
| V61 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 981 |   43.43 |
|  12 | employer                                                      |  10 |    0.44 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 822 |   36.39 |
|  51 | in other types of work                                        | 190 |    8.41 |
|  81 | did not work but was seeking and/or available for work        |  54 |    2.39 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   6 |    0.27 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   4 |    0.18 |

#+NAME:A1d6.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t16[ ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V63)]
#+END_SRC
#+RESULTS: A1d6.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  67 |    2.97 |
|                                     2 |   2 |    0.09 |
|                                     3 |   2 |    0.09 |
|                                     4 |   7 |    0.31 |
|                                     5 |  21 |    0.93 |
|                                     6 |  82 |    3.63 |
|                                     7 | 104 |     4.6 |
|                                     8 | 789 |   34.93 |
|                                     9 | 300 |   13.28 |
|                                    10 | 519 |   22.97 |
|                                    11 |  46 |    2.04 |
|                                    12 | 131 |     5.8 |
|                                    13 |   5 |    0.22 |
|                                    14 |   8 |    0.35 |
|                                    15 |   2 |    0.09 |

#+NAME:A1d6.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t16[V61 %in% c(51),.(.N, Percent = round(((.N/190)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V64)]
#+END_SRC
#+RESULTS: A1d6.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          150 |  1 |    0.53 |
|                          160 |  1 |    0.53 |
|                          200 | 19 |      10 |
|                          225 |  1 |    0.53 |
|                          250 | 19 |      10 |
|                          300 | 53 |   27.89 |
|                          320 |  1 |    0.53 |
|                          350 |  9 |    4.74 |
|                          400 | 80 |   42.11 |
|                          500 |  3 |    1.58 |
|                          600 |  2 |    1.05 |
|                          850 |  1 |    0.53 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:A2d6
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V66 %in% c(49,56)] -> A2d6
 StatusA2d6 <- data.table( V65 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2d6,StatusA2d6,by ="V65")-> A2d6
  A2d6[, .(.N, Percent = round(((.N/39)*100),2)), keyby=.(V65,status)]

#+END_SRC
#+RESULTS: A2d6
| V65 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 23 |   58.97 |
|  12 | employer                                                      |  3 |    7.69 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.26 |
|  31 | worked as regular salaried/ wage employee                     |  6 |   15.38 |
|  51 | in other types of work                                        |  3 |    7.69 |

#+NAME:A2d6.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2d6.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2d6.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_6=V67)]
#+END_SRC
#+RESULTS: A2d6.2
| hours_actually_worked_for_A1_on_day_6 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY6
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_6=V69)]
#+END_SRC
#+RESULTS: DAY6
| total_hours_worked_on_day_6 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 | 103 |    4.48 |
|                           2 |   3 |    0.13 |
|                           3 |   2 |    0.09 |
|                           4 |   9 |    0.39 |
|                           5 |  25 |    1.09 |
|                           6 |  90 |    3.92 |
|                           7 | 112 |    4.88 |
|                           8 | 844 |   36.74 |
|                           9 | 330 |   14.37 |
|                          10 | 560 |   24.38 |
|                          11 |  51 |    2.22 |
|                          12 | 149 |    6.49 |
|                          13 |   6 |    0.26 |
|                          14 |   9 |    0.39 |
|                          15 |   4 |    0.17 |

** Day 5
Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |


#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |

## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |

#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |

#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V55 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 25 |   65.79 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  4 |   10.53 |
|  51 | in other types of work                                        |  2 |    5.26 |

#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |

** Day 4
Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |


#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |

## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |

#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |

#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V55 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 25 |   65.79 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  4 |   10.53 |
|  51 | in other types of work                                        |  2 |    5.26 |

#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |

** Day 3

Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |


#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |

## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |

#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |

#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V55 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 25 |   65.79 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  4 |   10.53 |
|  51 | in other types of work                                        |  2 |    5.26 |

#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |

** Day 2

Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |


#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |

## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |

#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |

#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V55 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 25 |   65.79 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  4 |   10.53 |
|  51 | in other types of work                                        |  2 |    5.26 |

#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |

** Day 1
Analysing Activity status on Day 7
##Only have two digit NIC code classification
## Not sure if Activity 1 and Principal activity are same, but according the the major time criterion followed in the survey they should be same.
#+NAME:Activity1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V52 %in% c(49,56)] -> A1

 StatusA1 <- data.table( V51 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A1,StatusA1,by ="V51")-> A1
  A1[,.(.N,Percent=round(((.N/9925)*100),2)), keyby=.(V51,status)]

#+END_SRC
#+CAPTION:Status code of activity one
#+RESULTS: Activity1
| V51 | status                                                        |    N | Percent |
|-----+---------------------------------------------------------------+------+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 4410 |   44.43 |
|  12 | employer                                                      |  193 |    1.94 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  439 |    4.42 |
|  31 | worked as regular salaried/ wage employee                     | 3517 |   35.44 |
|  51 | in other types of work                                        |  908 |    9.15 |


#+Name: Checking if Activity 1 and Prinicipal activity have some similarity.
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
A[V5==2]-> t11
A1[V5==2]-> t12
t11[,.N,keyby=V52]
#+END_SRC 
#+CAPTION:NIC code distribution for Activity 1 on DAY 7 for the data with relevant Principal activity status.
#+RESULTS: Checking if Activity 1 and Prinicipal activity have some similarity.
| V52 |    N |
|-----+------|
| nil |   78 |
|   1 |    3 |
|  31 |    1 |
|  47 |    5 |
|  49 | 2155 |
|  52 |    2 |
|  56 |    5 |
|  59 |    1 |
|  77 |    1 |
|  79 |    2 |
|  84 |    1 |
|  85 |    1 |
|  86 |    1 |
|  96 |    3 |

## they seems quite similar, so will be using data with relevant principal activity status for Activity 1 analysis
#+Name:A1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
 merge(t11,StatusA1,by ="V51")-> t11
  t11[,.(.N,Percent=round(((.N/2259)*100),2)), keyby=.(V51,status)]
#+END_SRC
#+RESULTS: A1
| V51 | status                                                        |   N | Percent |
|-----+---------------------------------------------------------------+-----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 999 |   44.22 |
|  12 | employer                                                      |  12 |    0.53 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  15 |    0.66 |
|  31 | worked as regular salaried/ wage employee                     | 847 |   37.49 |
|  51 | in other types of work                                        | 207 |    9.16 |
|  81 | did not work but was seeking and/or available for work        |  39 |    1.73 |
|  91 | attended educational institution                              |   1 |    0.04 |
|  92 | attended domestic duties only                                 |   5 |    0.22 |
|  94 | rentiers, pensioners , remittance recipients, etc             |   1 |    0.04 |
|  95 | not able to work due to disability                            |   1 |    0.04 |
|  97 | others (including begging, prostitution, etc.)                |   5 |    0.22 |

#+NAME:A1.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(11,12,21,31,51,81,95) ,.(.N, Percent = round(((.N/2259)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V53)]
#+END_SRC
#+RESULTS: A1.1
| hours_actually_worked_for_A1_on_day_7 |   N | Percent |
|---------------------------------------+-----+---------|
|                                     0 |  40 |    1.77 |
|                                     2 |   2 |    0.09 |
|                                     3 |   4 |    0.18 |
|                                     4 |   4 |    0.18 |
|                                     5 |  22 |    0.97 |
|                                     6 |  77 |    3.41 |
|                                     7 |  88 |     3.9 |
|                                     8 | 833 |   36.87 |
|                                     9 | 301 |   13.32 |
|                                    10 | 553 |   24.48 |
|                                    11 |  43 |     1.9 |
|                                    12 | 143 |    6.33 |
|                                    13 |   4 |    0.18 |
|                                    14 |   5 |    0.22 |
|                                    15 |   1 |    0.04 |

#+NAME:A1.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
t11[V51 %in% c(51),.(.N, Percent = round(((.N/207)*100),2)),keyby = .(wage_earning_for_A1_on_day_7=V54)]
#+END_SRC
#+RESULTS: A1.2
| wage_earning_for_A1_on_day_7 |  N | Percent |
|------------------------------+----+---------|
|                          100 |  1 |    0.48 |
|                          150 |  2 |    0.97 |
|                          160 |  1 |    0.48 |
|                          200 | 20 |    9.66 |
|                          250 | 17 |    8.21 |
|                          300 | 59 |    28.5 |
|                          320 |  1 |    0.48 |
|                          350 | 11 |    5.31 |
|                          380 |  1 |    0.48 |
|                          400 | 87 |   42.03 |
|                          500 |  2 |    0.97 |
|                          600 |  2 |    0.97 |
|                          700 |  1 |    0.48 |
|                          800 |  1 |    0.48 |
|                          850 |  1 |    0.48 |
## Wage earnings are recorded for each day for activity status41,42,51.

#+NAME:Activity2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
D[V56 %in% c(49,56)] -> A2
 StatusA2 <- data.table( V55 = 
    c(11,12,21,31,41,51,81,91,92,93,94,95,97), 
    status = c("worked in h.h. enterprise (self-employed): own account worker",
               "employer",
               "worked as helper in h.h. enterprise (unpaid family worker)",
               " worked as regular salaried/ wage employee",
               "worked as casual wage labour: in public works",
               "in other types of work",
               "did not work but was seeking and/or available for work",
               " attended educational institution",
               "attended domestic duties only",
               "attended domestic duties and  engaged in free collection of goods,sewing,etc.for hh use",
               "rentiers, pensioners , remittance recipients, etc",
               "not able to work due to disability",
               " others (including begging, prostitution, etc.)"
               )
  )
  merge(A2,StatusA2,by ="V55")-> A2
  A2[, .(.N, Percent = round(((.N/38)*100),2)), keyby=.(V55,status)]

#+END_SRC
#+RESULTS: Activity2
| V55 | status                                                        |  N | Percent |
|-----+---------------------------------------------------------------+----+---------|
|  11 | worked in h.h. enterprise (self-employed): own account worker | 25 |   65.79 |
|  12 | employer                                                      |  3 |    7.89 |
|  21 | worked as helper in h.h. enterprise (unpaid family worker)    |  4 |   10.53 |
|  31 | worked as regular salaried/ wage employee                     |  4 |   10.53 |
|  51 | in other types of work                                        |  2 |    5.26 |

#+NAME:A2.1
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5==2,.N,keyby = .(NIC_code_for_Activity_2=V56)]
#+END_SRC
#+RESULTS: A2.1
| NIC_code_for_Activity_2 |  N |
|-------------------------+----|
|                     nil | 32 |
|                      49 |  5 |
|                      56 |  1 |

#+NAME:A2.2
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
F[V5 %in% c(2),.(.N, Percent = round(((.N/38)*100),2)),keyby = .(hours_actually_worked_for_A1_on_day_7=V57)]
#+END_SRC
#+RESULTS: A2.2
| hours_actually_worked_for_A1_on_day_7 |  N | Percent |
|---------------------------------------+----+---------|
|                                     0 | 32 |   84.21 |
|                                     2 |  1 |    2.63 |
|                                     4 |  4 |   10.53 |
|                                     5 |  1 |    2.63 |



#+NAME:DAY7
#+BEGIN_SRC R :session plfs :results value :exports results :colnames yes :hline Yes
  l1 <-D[V33 %in% c(49219,56104,49223,49224,49231) & V34 %in% c(832,512,933)]

 D[V35 == 1 & V43 %in% c(49219,56104,49223,49224,49231,56101,49232) & V44 %in% c(832,512,933)] -> l2
rbind(l1,l2)-> R7
unique(R7)-> R7
R7[V5==2,.(.N, Percent = round(((.N/2297)*100),2)),keyby=.(total_hours_worked_on_day_7=V59)]
#+END_SRC
#+RESULTS: DAY7
| total_hours_worked_on_day_7 |   N | Percent |
|-----------------------------+-----+---------|
|                           0 |  85 |     3.7 |
|                           3 |   6 |    0.26 |
|                           4 |   5 |    0.22 |
|                           5 |  24 |    1.04 |
|                           6 |  86 |    3.74 |
|                           7 |  92 |    4.01 |
|                           8 | 882 |    38.4 |
|                           9 | 320 |   13.93 |
|                          10 | 580 |   25.25 |
|                          11 |  45 |    1.96 |
|                          12 | 156 |    6.79 |
|                          13 |   7 |     0.3 |
|                          14 |   6 |    0.26 |
|                          15 |   3 |    0.13 |


